<!DOCTYPE HTML>
<html lang="vi" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Arrays in Assembly - Đắm mình vào hệ thống - Dive into Systems</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> Home</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../copyright.html"><strong aria-hidden="true">1.1.</strong> Copyright</a></li><li class="chapter-item expanded "><a href="../acknowledgements.html"><strong aria-hidden="true">1.2.</strong> Acknowledgements</a></li><li class="chapter-item expanded "><a href="../preface.html"><strong aria-hidden="true">1.3.</strong> Preface</a></li></ol></li><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">2.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../C4-Binary/index.html"><strong aria-hidden="true">3.</strong> Binary and Data Representation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C4-Binary/bases.html"><strong aria-hidden="true">3.1.</strong> Number Bases and Unsigned Integers</a></li><li class="chapter-item expanded "><a href="../C4-Binary/conversion.html"><strong aria-hidden="true">3.2.</strong> Converting Between Bases</a></li><li class="chapter-item expanded "><a href="../C4-Binary/signed.html"><strong aria-hidden="true">3.3.</strong> Signed Binary Integers</a></li><li class="chapter-item expanded "><a href="../C4-Binary/arithmetic.html"><strong aria-hidden="true">3.4.</strong> Binary Integer Arithmetic</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C4-Binary/arithmetic_addition.html"><strong aria-hidden="true">3.4.1.</strong> Addition</a></li><li class="chapter-item expanded "><a href="../C4-Binary/arithmetic_subtraction.html"><strong aria-hidden="true">3.4.2.</strong> Subtraction</a></li><li class="chapter-item expanded "><a href="../C4-Binary/arithmetic_mult_div.html"><strong aria-hidden="true">3.4.3.</strong> Multiplication & Division</a></li></ol></li><li class="chapter-item expanded "><a href="../C4-Binary/overflow.html"><strong aria-hidden="true">3.5.</strong> Overflow</a></li><li class="chapter-item expanded "><a href="../C4-Binary/bitwise.html"><strong aria-hidden="true">3.6.</strong> Bitwise Operators</a></li><li class="chapter-item expanded "><a href="../C4-Binary/byte_order.html"><strong aria-hidden="true">3.7.</strong> Integer Byte Order</a></li><li class="chapter-item expanded "><a href="../C4-Binary/floating_point.html"><strong aria-hidden="true">3.8.</strong> Real Numbers in Binary</a></li><li class="chapter-item expanded "><a href="../C4-Binary/summary.html"><strong aria-hidden="true">3.9.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../C5-Arch/index.html"><strong aria-hidden="true">4.</strong> What von Neumann Knew: Computer Architecture</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C5-Arch/hist.html"><strong aria-hidden="true">4.1.</strong> The Origins of Modern Computing</a></li><li class="chapter-item expanded "><a href="../C5-Arch/von.html"><strong aria-hidden="true">4.2.</strong> The von Neumann Architecture</a></li><li class="chapter-item expanded "><a href="../C5-Arch/gates.html"><strong aria-hidden="true">4.3.</strong> Logic Gates</a></li><li class="chapter-item expanded "><a href="../C5-Arch/circuits.html"><strong aria-hidden="true">4.4.</strong> Circuits</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C5-Arch/arithlogiccircs.html"><strong aria-hidden="true">4.4.1.</strong> Arithmetic and Logic Circuits</a></li><li class="chapter-item expanded "><a href="../C5-Arch/controlcircs.html"><strong aria-hidden="true">4.4.2.</strong> Control Circuits</a></li><li class="chapter-item expanded "><a href="../C5-Arch/storagecircs.html"><strong aria-hidden="true">4.4.3.</strong> Storage Circuits</a></li></ol></li><li class="chapter-item expanded "><a href="../C5-Arch/cpu.html"><strong aria-hidden="true">4.5.</strong> Building a Processor</a></li><li class="chapter-item expanded "><a href="../C5-Arch/instrexec.html"><strong aria-hidden="true">4.6.</strong> The Processor’s Execution of Program Instructions</a></li><li class="chapter-item expanded "><a href="../C5-Arch/pipelining.html"><strong aria-hidden="true">4.7.</strong> Pipelining Instruction Execution</a></li><li class="chapter-item expanded "><a href="../C5-Arch/pipelining_advanced.html"><strong aria-hidden="true">4.8.</strong> Advanced Pipelining Considerations</a></li><li class="chapter-item expanded "><a href="../C5-Arch/modern.html"><strong aria-hidden="true">4.9.</strong> Looking Ahead: CPUs Today</a></li><li class="chapter-item expanded "><a href="../C5-Arch/summary.html"><strong aria-hidden="true">4.10.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../C6-asm_intro/index.html"><strong aria-hidden="true">5.</strong> Under the C: Dive into Assembly</a></li><li class="chapter-item expanded "><a href="../C7-x86_64/index.html"><strong aria-hidden="true">6.</strong> -bit x86 Assembly</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C7-x86_64/basics.html"><strong aria-hidden="true">6.1.</strong> Assembly Basics</a></li><li class="chapter-item expanded "><a href="../C7-x86_64/common.html"><strong aria-hidden="true">6.2.</strong> Common Instructions</a></li><li class="chapter-item expanded "><a href="../C7-x86_64/arithmetic.html"><strong aria-hidden="true">6.3.</strong> Additional Arithmetic Instructions</a></li><li class="chapter-item expanded "><a href="../C7-x86_64/conditional_control_loops.html"><strong aria-hidden="true">6.4.</strong> Conditional Control and Loops</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C7-x86_64/preliminaries.html"><strong aria-hidden="true">6.4.1.</strong> Preliminaries</a></li><li class="chapter-item expanded "><a href="../C7-x86_64/if_statements.html"><strong aria-hidden="true">6.4.2.</strong> If Statements</a></li><li class="chapter-item expanded "><a href="../C7-x86_64/loops.html"><strong aria-hidden="true">6.4.3.</strong> Loops</a></li></ol></li><li class="chapter-item expanded "><a href="../C7-x86_64/functions.html"><strong aria-hidden="true">6.5.</strong> Functions in Assembly</a></li><li class="chapter-item expanded "><a href="../C7-x86_64/recursion.html"><strong aria-hidden="true">6.6.</strong> Recursion</a></li><li class="chapter-item expanded "><a href="../C7-x86_64/arrays.html" class="active"><strong aria-hidden="true">6.7.</strong> Arrays in Assembly</a></li><li class="chapter-item expanded "><a href="../C7-x86_64/matrices.html"><strong aria-hidden="true">6.8.</strong> Matrices in Assembly</a></li><li class="chapter-item expanded "><a href="../C7-x86_64/structs.html"><strong aria-hidden="true">6.9.</strong> Structs in Assembly</a></li><li class="chapter-item expanded "><a href="../C7-x86_64/buffer_overflow.html"><strong aria-hidden="true">6.10.</strong> Buffer Overflows</a></li></ol></li><li class="chapter-item expanded "><a href="../C8-IA32/index.html"><strong aria-hidden="true">7.</strong> 64-bit x86 Assembly</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C8-IA32/basics.html"><strong aria-hidden="true">7.1.</strong> Assembly Basics</a></li><li class="chapter-item expanded "><a href="../C8-IA32/common.html"><strong aria-hidden="true">7.2.</strong> Common Instructions</a></li><li class="chapter-item expanded "><a href="../C8-IA32/arithmetic.html"><strong aria-hidden="true">7.3.</strong> Additional Arithmetic Instructions</a></li><li class="chapter-item expanded "><a href="../C8-IA32/conditional_control_loops.html"><strong aria-hidden="true">7.4.</strong> Conditional Control and Loops</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C8-IA32/preliminaries.html"><strong aria-hidden="true">7.4.1.</strong> Preliminaries</a></li><li class="chapter-item expanded "><a href="../C8-IA32/if_statements.html"><strong aria-hidden="true">7.4.2.</strong> If Statements</a></li><li class="chapter-item expanded "><a href="../C8-IA32/loops.html"><strong aria-hidden="true">7.4.3.</strong> Loops</a></li></ol></li><li class="chapter-item expanded "><a href="../C8-IA32/functions.html"><strong aria-hidden="true">7.5.</strong> Functions in Assembly</a></li><li class="chapter-item expanded "><a href="../C8-IA32/recursion.html"><strong aria-hidden="true">7.6.</strong> Recursion</a></li><li class="chapter-item expanded "><a href="../C8-IA32/arrays.html"><strong aria-hidden="true">7.7.</strong> Arrays in Assembly</a></li><li class="chapter-item expanded "><a href="../C8-IA32/matrices.html"><strong aria-hidden="true">7.8.</strong> Matrices in Assembly</a></li><li class="chapter-item expanded "><a href="../C8-IA32/structs.html"><strong aria-hidden="true">7.9.</strong> Structs in Assembly</a></li><li class="chapter-item expanded "><a href="../C8-IA32/buffer_overflow.html"><strong aria-hidden="true">7.10.</strong> Buffer Overflows</a></li></ol></li><li class="chapter-item expanded "><a href="../C9-ARM64/index.html"><strong aria-hidden="true">8.</strong> ARMv8 Assembly</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C9-ARM64/basics.html"><strong aria-hidden="true">8.1.</strong> Assembly Basics</a></li><li class="chapter-item expanded "><a href="../C9-ARM64/common.html"><strong aria-hidden="true">8.2.</strong> Common Instructions</a></li><li class="chapter-item expanded "><a href="../C9-ARM64/arithmetic.html"><strong aria-hidden="true">8.3.</strong> Arithmetic Instructions</a></li><li class="chapter-item expanded "><a href="../C9-ARM64/conditional_control_loops.html"><strong aria-hidden="true">8.4.</strong> Conditional Control and Loops</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C9-ARM64/preliminaries.html"><strong aria-hidden="true">8.4.1.</strong> Preliminaries</a></li><li class="chapter-item expanded "><a href="../C9-ARM64/if_statements.html"><strong aria-hidden="true">8.4.2.</strong> If Statements</a></li><li class="chapter-item expanded "><a href="../C9-ARM64/loops.html"><strong aria-hidden="true">8.4.3.</strong> Loops</a></li></ol></li><li class="chapter-item expanded "><a href="../C9-ARM64/functions.html"><strong aria-hidden="true">8.5.</strong> Functions in Assembly</a></li><li class="chapter-item expanded "><a href="../C9-ARM64/recursion.html"><strong aria-hidden="true">8.6.</strong> Recursion</a></li><li class="chapter-item expanded "><a href="../C9-ARM64/arrays.html"><strong aria-hidden="true">8.7.</strong> Arrays in Assembly</a></li><li class="chapter-item expanded "><a href="../C9-ARM64/matrices.html"><strong aria-hidden="true">8.8.</strong> Matrices in Assembly</a></li><li class="chapter-item expanded "><a href="../C9-ARM64/structs.html"><strong aria-hidden="true">8.9.</strong> Structs in Assembly</a></li><li class="chapter-item expanded "><a href="../C9-ARM64/buffer_overflow.html"><strong aria-hidden="true">8.10.</strong> Buffer Overflows</a></li></ol></li><li class="chapter-item expanded "><a href="../C10-asm_takeaways/index.html"><strong aria-hidden="true">9.</strong> Key Assembly Takeaways</a></li><li class="chapter-item expanded "><a href="../C11-MemHierarchy/index.html"><strong aria-hidden="true">10.</strong> Storage and the Memory Hierarchy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C11-MemHierarchy/mem_hierarchy.html"><strong aria-hidden="true">10.1.</strong> The Memory Hierarchy</a></li><li class="chapter-item expanded "><a href="../C11-MemHierarchy/devices.html"><strong aria-hidden="true">10.2.</strong> Storage Devices</a></li><li class="chapter-item expanded "><a href="../C11-MemHierarchy/locality.html"><strong aria-hidden="true">10.3.</strong> Locality</a></li><li class="chapter-item expanded "><a href="../C11-MemHierarchy/caching.html"><strong aria-hidden="true">10.4.</strong> Caching</a></li><li class="chapter-item expanded "><a href="../C11-MemHierarchy/cachegrind.html"><strong aria-hidden="true">10.5.</strong> Cache Analysis and Cachegrind</a></li><li class="chapter-item expanded "><a href="../C11-MemHierarchy/coherency.html"><strong aria-hidden="true">10.6.</strong> Looking Ahead: Caching on Multicore Processors</a></li><li class="chapter-item expanded "><a href="../C11-MemHierarchy/summary.html"><strong aria-hidden="true">10.7.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../C12-CodeOpt/index.html"><strong aria-hidden="true">11.</strong> Code Optimization</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C12-CodeOpt/basic.html"><strong aria-hidden="true">11.1.</strong> First Steps</a></li><li class="chapter-item expanded "><a href="../C12-CodeOpt/loops_functions.html"><strong aria-hidden="true">11.2.</strong> Other Compiler Optimizations</a></li><li class="chapter-item expanded "><a href="../C12-CodeOpt/memory_considerations.html"><strong aria-hidden="true">11.3.</strong> Memory Considerations</a></li><li class="chapter-item expanded "><a href="../C12-CodeOpt/summary.html"><strong aria-hidden="true">11.4.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../C13-OS/index.html"><strong aria-hidden="true">12.</strong> The Operating System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C13-OS/impl.html"><strong aria-hidden="true">12.1.</strong> Booting and Running</a></li><li class="chapter-item expanded "><a href="../C13-OS/processes.html"><strong aria-hidden="true">12.2.</strong> Processes</a></li><li class="chapter-item expanded "><a href="../C13-OS/vm.html"><strong aria-hidden="true">12.3.</strong> Virtual Memory</a></li><li class="chapter-item expanded "><a href="../C13-OS/ipc.html"><strong aria-hidden="true">12.4.</strong> Interprocess Communication</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C13-OS/ipc_signals.html"><strong aria-hidden="true">12.4.1.</strong> Signals</a></li><li class="chapter-item expanded "><a href="../C13-OS/ipc_msging.html"><strong aria-hidden="true">12.4.2.</strong> Message Passing</a></li><li class="chapter-item expanded "><a href="../C13-OS/ipc_shm.html"><strong aria-hidden="true">12.4.3.</strong> Shared Memory</a></li></ol></li><li class="chapter-item expanded "><a href="../C13-OS/advanced.html"><strong aria-hidden="true">12.5.</strong> Summary and Other OS Functionality</a></li></ol></li><li class="chapter-item expanded "><a href="../C14-SharedMemory/index.html"><strong aria-hidden="true">13.</strong> Leveraging Shared Memory in the Multicore Era</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C14-SharedMemory/multicore.html"><strong aria-hidden="true">13.1.</strong> Programming Multicore Systems</a></li><li class="chapter-item expanded "><a href="../C14-SharedMemory/posix.html"><strong aria-hidden="true">13.2.</strong> POSIX Threads</a></li><li class="chapter-item expanded "><a href="../C14-SharedMemory/synchronization.html"><strong aria-hidden="true">13.3.</strong> Synchronizing Threads</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C14-SharedMemory/mutex.html"><strong aria-hidden="true">13.3.1.</strong> Mutual Exclusion</a></li><li class="chapter-item expanded "><a href="../C14-SharedMemory/semaphores.html"><strong aria-hidden="true">13.3.2.</strong> Semaphores</a></li><li class="chapter-item expanded "><a href="../C14-SharedMemory/other_syncs.html"><strong aria-hidden="true">13.3.3.</strong> Other Synchronization Constructs</a></li></ol></li><li class="chapter-item expanded "><a href="../C14-SharedMemory/performance.html"><strong aria-hidden="true">13.4.</strong> Measuring Parallel Performance</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C14-SharedMemory/performance_basics.html"><strong aria-hidden="true">13.4.1.</strong> Parallel Performance Basics</a></li><li class="chapter-item expanded "><a href="../C14-SharedMemory/performance_advanced.html"><strong aria-hidden="true">13.4.2.</strong> Advanced Topics</a></li></ol></li><li class="chapter-item expanded "><a href="../C14-SharedMemory/cache_coherence.html"><strong aria-hidden="true">13.5.</strong> Cache Coherence</a></li><li class="chapter-item expanded "><a href="../C14-SharedMemory/thread_safety.html"><strong aria-hidden="true">13.6.</strong> Thread Safety</a></li><li class="chapter-item expanded "><a href="../C14-SharedMemory/openmp.html"><strong aria-hidden="true">13.7.</strong> Implicit Threading with OpenMP</a></li><li class="chapter-item expanded "><a href="../C14-SharedMemory/summary.html"><strong aria-hidden="true">13.8.</strong> Summary</a></li></ol></li><li class="chapter-item expanded "><a href="../C15-Parallel/index.html"><strong aria-hidden="true">14.</strong> Looking Ahead: Other Parallel Systems</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../C15-Parallel/gpu.html"><strong aria-hidden="true">14.1.</strong> Hardware Acceleration and CUDA</a></li><li class="chapter-item expanded "><a href="../C15-Parallel/distrmem.html"><strong aria-hidden="true">14.2.</strong> Distributed Memory Systems</a></li><li class="chapter-item expanded "><a href="../C15-Parallel/cloud.html"><strong aria-hidden="true">14.3.</strong> To Exascale and Beyond</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Đắm mình vào hệ thống - Dive into Systems</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="77-mảng-arrays"><a class="header" href="#77-mảng-arrays">7.7. Mảng (Arrays)</a></h2>
<p>Hãy nhớ rằng <a href="../C1-C_intro/arrays_strings.html#_introduction_to_arrays">arrays</a> (mảng) là tập hợp có thứ tự của các phần tử dữ liệu cùng kiểu, được lưu trữ liên tiếp trong bộ nhớ. Các <a href="../C2-C_depth/arrays.html#_single_dimensional_arrays">single-dimension arrays</a> (mảng một chiều) được cấp phát tĩnh có dạng <code>Type arr[N]</code>, trong đó <code>Type</code> là kiểu dữ liệu, <code>arr</code> là tên định danh của mảng, và <code>N</code> là số phần tử dữ liệu. Khai báo mảng tĩnh như <code>Type arr[N]</code> hoặc cấp phát động như <code>arr = malloc(N * sizeof(Type))</code> sẽ chiếm tổng cộng <em>N</em> × sizeof(<em>Type</em>) byte bộ nhớ.</p>
<p>Để truy cập phần tử tại chỉ số <em>i</em> trong mảng <code>arr</code>, sử dụng cú pháp <code>arr[i]</code>. <strong>Compiler</strong> thường chuyển đổi các truy cập mảng thành <a href="../C2-C_depth/pointers.html#_pointer_variables">pointer arithmetic</a> (tính toán con trỏ) trước khi dịch sang assembly. Do đó, <code>arr + i</code> tương đương với <code>&amp;arr[i]</code>, và <code>*(arr + i)</code> tương đương với <code>arr[i]</code>. Vì mỗi phần tử trong <code>arr</code> có kiểu <code>Type</code>, nên <code>arr + i</code> ngụ ý rằng phần tử <em>i</em> được lưu tại địa chỉ <code>arr + sizeof(Type) * i</code>.</p>
<p><strong>Bảng 1</strong> dưới đây tóm tắt một số thao tác mảng phổ biến và lệnh assembly tương ứng. Trong các ví dụ sau, giả sử ta khai báo một mảng <code>int</code> có độ dài 10 (<code>int arr[10]</code>). Giả sử thanh ghi <code>%rdx</code> lưu địa chỉ của <code>arr</code>, thanh ghi <code>%rcx</code> lưu giá trị <code>int</code> là <code>i</code>, và thanh ghi <code>%rax</code> biểu diễn một biến <code>x</code> (cũng có kiểu <code>int</code>). Hãy nhớ rằng biến <code>int</code> chiếm 4 byte, trong khi biến <code>int *</code> chiếm 8 byte.</p>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Type</th><th>Assembly Representation</th></tr></thead><tbody>
<tr><td><code>x = arr</code></td><td><code>int *</code></td><td><code>mov %rdx, %rax</code></td></tr>
<tr><td><code>x = arr[0]</code></td><td><code>int</code></td><td><code>mov (%rdx), %eax</code></td></tr>
<tr><td><code>x = arr[i]</code></td><td><code>int</code></td><td><code>mov (%rdx, %rcx,4), %eax</code></td></tr>
<tr><td><code>x = &amp;arr[3]</code></td><td><code>int *</code></td><td><code>lea 0xc(%rdx), %rax</code></td></tr>
<tr><td><code>x = arr+3</code></td><td><code>int *</code></td><td><code>lea 0xc(%rdx), %rax</code></td></tr>
<tr><td><code>x = *(arr+5)</code></td><td><code>int</code></td><td><code>mov 0x14(%rdx), %eax</code></td></tr>
</tbody></table>
</div>
<p><strong>Bảng 1.</strong> Các thao tác mảng phổ biến và lệnh assembly tương ứng.</p>
<p>Hãy chú ý đến <em>type</em> (kiểu dữ liệu) của từng biểu thức trong <a href="#ArrayOps">Bảng 1</a>. Nói chung, compiler sử dụng lệnh <code>mov</code> để <strong>dereference</strong> (giải tham chiếu) con trỏ và lệnh <code>lea</code> để tính toán địa chỉ.</p>
<p>Lưu ý rằng để truy cập phần tử <code>arr[3]</code> (hoặc <code>*(arr+3)</code> khi dùng pointer arithmetic), compiler thực hiện truy xuất bộ nhớ tại địa chỉ <code>arr + 3*4</code> thay vì <code>arr + 3</code>. Để hiểu tại sao, hãy nhớ rằng bất kỳ phần tử nào tại chỉ số <em>i</em> trong mảng được lưu tại địa chỉ <code>arr + sizeof(Type) * i</code>. Do đó, compiler phải nhân chỉ số với kích thước của kiểu dữ liệu (trong trường hợp này là 4, vì <code>sizeof(int) = 4</code>) để tính toán đúng <strong>offset</strong> (độ lệch). Cũng cần nhớ rằng bộ nhớ được <strong>byte-addressable</strong> (địa chỉ hóa theo byte); việc dịch chuyển đúng số byte tương đương với việc tính toán địa chỉ. Cuối cùng, vì giá trị <code>int</code> chỉ cần 4 byte, nên chúng được lưu trong <strong>component register</strong> <code>%eax</code> của thanh ghi <code>%rax</code>.</p>
<p>Ví dụ, xét một mảng (<code>array</code>) gồm 10 phần tử kiểu <code>int</code> (Hình 1):</p>
<p><img src="_images/arrayFig.png" alt="Each integer in the array requires four bytes." /></p>
<p><strong>Hình 1.</strong> Cách bố trí một mảng 10 số nguyên trong bộ nhớ. Mỗi ô được gắn nhãn x~i~ biểu diễn 4 byte.</p>
<p>Vì <code>array</code> là mảng số nguyên, mỗi phần tử chiếm đúng 4 byte. Do đó, một mảng <code>int</code> gồm 10 phần tử chiếm 40 byte bộ nhớ liên tiếp.</p>
<p>Để tính địa chỉ của phần tử thứ 3, compiler nhân chỉ số 3 với kích thước dữ liệu của kiểu <code>int</code> (4) để được offset là 12 (hay 0xc). Quả thật, phần tử thứ 3 trong Hình 1 nằm tại byte offset x~12~.</p>
<p>Hãy xem một hàm C đơn giản <code>sumArray</code> tính tổng tất cả các phần tử trong mảng:</p>
<pre><code class="language-c">int sumArray(int *array, int length) {
    int i, total = 0;
    for (i = 0; i &lt; length; i++) {
        total += array[i];
    }
    return total;
}
</code></pre>
<p>Hàm <code>sumArray</code> nhận địa chỉ của một mảng và độ dài tương ứng, sau đó cộng dồn tất cả các phần tử trong mảng. Bây giờ, hãy xem đoạn mã assembly tương ứng của hàm <code>sumArray</code>:</p>
<pre><code>0x400686 &lt;+0&gt;:   push %rbp                   # save %rbp
0x400687 &lt;+1&gt;:    mov  %rsp,%rbp              # update %rbp (new stack frame)
0x40068a &lt;+4&gt;:    mov  %rdi,-0x18(%rbp)       # copy array to %rbp-0x18
0x40068e &lt;+8&gt;:    mov  %esi,-0x1c(%rbp)       # copy length to %rbp-0x1c
0x400691 &lt;+11&gt;:   movl $0x0,-0x4(%rbp)        # copy 0 to %rbp-0x4 (total)
0x400698 &lt;+18&gt;:   movl $0x0,-0x8(%rbp)        # copy 0 to %rbp-0x8 (i)
0x40069f &lt;+25&gt;:   jmp  0x4006be &lt;sumArray+56&gt; # goto &lt;sumArray+56&gt;
0x4006a1 &lt;+27&gt;:   mov  -0x8(%rbp),%eax        # copy i to %eax
0x4006a4 &lt;+30&gt;:   cltq                        # convert i to a 64-bit integer
0x4006a6 &lt;+32&gt;:   lea  0x0(,%rax,4),%rdx      # copy i*4 to %rdx
0x4006ae &lt;+40&gt;:   mov  -0x18(%rbp),%rax       # copy array to %rax
0x4006b2 &lt;+44&gt;:   add  %rdx,%rax              # compute array+i*4, store in %rax
0x4006b5 &lt;+47&gt;:   mov  (%rax),%eax            # copy array[i] to %eax
0x4006b7 &lt;+49&gt;:   add  %eax,-0x4(%rbp)        # add %eax to total
0x4006ba &lt;+52&gt;:   addl $0x1,-0x8(%rbp)        # add 1 to i (i+=1)
0x4006be &lt;+56&gt;:   mov  -0x8(%rbp),%eax        # copy i to %eax
0x4006c1 &lt;+59&gt;:   cmp  -0x1c(%rbp),%eax       # compare i to length
0x4006c4 &lt;+62&gt;:   jl   0x4006a1 &lt;sumArray+27&gt; # if i&lt;length goto &lt;sumArray+27&gt;
0x4006c6 &lt;+64&gt;:   mov  -0x4(%rbp),%eax        # copy total to %eax
0x4006c9 &lt;+67&gt;:   pop  %rbp                   # prepare to leave the function
0x4006ca &lt;+68&gt;:   retq                        # return total
</code></pre>
<p>Khi lần theo đoạn mã assembly này, hãy xem xét liệu dữ liệu được truy cập là một <strong>địa chỉ</strong> hay một <strong>giá trị</strong>. Ví dụ, lệnh tại <code>&lt;sumArray+11&gt;</code> khiến vị trí <code>%rbp-0x4</code> chứa một biến kiểu <code>int</code>, ban đầu được gán giá trị 0. Ngược lại, đối số được lưu tại <code>%rbp-0x18</code> là đối số thứ nhất của hàm (<code>array</code>), có kiểu <code>int *</code> và tương ứng với địa chỉ gốc (base address) của mảng. Một biến khác (mà ta gọi là <code>i</code>) được lưu tại vị trí <code>%rbp-0x8</code>. Cuối cùng, lưu ý rằng <strong>size suffix</strong> (hậu tố kích thước) chỉ được thêm vào cuối các lệnh như <code>add</code> và <code>mov</code> khi cần thiết. Trong các trường hợp liên quan đến hằng số, compiler cần chỉ rõ số byte của hằng số sẽ được di chuyển.</p>
<p>Người đọc tinh ý sẽ nhận thấy một lệnh chưa từng thấy trước đây tại dòng <code>&lt;sumArray+30&gt;</code> có tên <code>cltq</code>. Lệnh <code>cltq</code> là viết tắt của <em>convert long to quad</em> (chuyển từ long sang quad) và chuyển giá trị <code>int</code> 32-bit được lưu trong <code>%eax</code> thành giá trị số nguyên 64-bit được lưu trong <code>%rax</code>. Thao tác này là cần thiết vì các lệnh tiếp theo sẽ thực hiện <strong>pointer arithmetic</strong> (tính toán trên con trỏ). Hãy nhớ rằng trên hệ thống 64-bit, con trỏ chiếm 8 byte. Việc compiler sử dụng <code>cltq</code> giúp đơn giản hóa quá trình bằng cách đảm bảo tất cả dữ liệu được lưu trong các thanh ghi 64-bit thay vì các thành phần 32-bit.</p>
<p>Hãy cùng xem kỹ hơn năm lệnh nằm giữa các vị trí <code>&lt;sumArray+32&gt;</code> và <code>&lt;sumArray+49&gt;</code>:</p>
<pre><code>&lt;+32&gt;: lea 0x0(,%rax,4),%rdx       # copy i*4 to %rdx
&lt;+40&gt;: mov -0x18(%rbp),%rax        # copy array to %rax
&lt;+44&gt;: add %rdx,%rax               # add i*4 to array (i.e. array+i) to %rax
&lt;+47&gt;: mov (%rax),%eax             # dereference array+i*4, place in %eax
&lt;+49&gt;: add %eax,-0x4(%rbp)         # add %eax to total (i.e. total+=array[i])
</code></pre>
<p>Hãy nhớ rằng compiler thường dùng <code>lea</code> để thực hiện các phép toán số học đơn giản trên toán hạng. Toán hạng <code>0x0(,%rax,4)</code> được dịch thành <code>%rax*4 + 0x0</code>. Vì <code>%rax</code> giữ giá trị của <code>i</code>, thao tác này sao chép giá trị <code>i*4</code> vào <code>%rdx</code>. Tại thời điểm này, <code>%rdx</code> chứa số byte cần thiết để tính đúng <strong>offset</strong> (độ lệch) của <code>array[i]</code> (hãy nhớ rằng <code>sizeof(int) = 4</code>).</p>
<p>Lệnh tiếp theo (<code>mov -0x18(%rbp), %rax</code>) sao chép đối số thứ nhất của hàm (địa chỉ gốc của <code>array</code>) vào thanh ghi <code>%rax</code>. Việc cộng <code>%rdx</code> vào <code>%rax</code> ở lệnh tiếp theo khiến <code>%rax</code> chứa <code>array + i*4</code>. Hãy nhớ rằng phần tử tại chỉ số <em>i</em> trong <code>array</code> được lưu tại địa chỉ <code>array + sizeof(T) * i</code>. Do đó, <code>%rax</code> hiện chứa kết quả tính toán ở mức assembly của địa chỉ <code>&amp;array[i]</code>.</p>
<p>Lệnh tại <code>&lt;sumArray+47&gt;</code> <strong>dereference</strong> (giải tham chiếu) giá trị tại địa chỉ <code>%rax</code>, đặt giá trị của <code>array[i]</code> vào <code>%eax</code>. Lưu ý việc sử dụng <strong>component register</strong> <code>%eax</code>, vì <code>array[i]</code> chứa giá trị <code>int</code> 32-bit! Ngược lại, biến <code>i</code> đã được chuyển thành <strong>quad-word</strong> ở dòng <code>&lt;sumArray+30&gt;</code> vì <code>i</code> sắp được dùng cho <em>address computation</em> (tính toán địa chỉ). Một lần nữa, địa chỉ được lưu dưới dạng từ 64-bit.</p>
<p>Cuối cùng, <code>%eax</code> được cộng vào giá trị tại <code>%rbp-0x4</code>, tức là biến <code>total</code>. Do đó, năm lệnh nằm giữa các vị trí <code>&lt;sumArray+32&gt;</code> và <code>&lt;sumArray+49&gt;</code> tương ứng với dòng <code>total += array[i]</code> trong hàm <code>sumArray</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../C7-x86_64/recursion.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../C7-x86_64/matrices.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../C7-x86_64/recursion.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../C7-x86_64/matrices.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
