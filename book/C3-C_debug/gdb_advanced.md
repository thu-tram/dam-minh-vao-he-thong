
### [Dive Into Systems](../index-2.html) {#dive-into-systems .title}

-   -   [Dive Into Systems]{.nav-text}
        -   [Authors](../index-2.html){.nav-link}
        -   [Copyright](../copyright.html){.nav-link}
        -   [Acknowledgements](../acknowledgements.html){.nav-link}
        -   [Preface](../preface.html){.nav-link}
    -   [0. Introduction](../introduction.html){.nav-link}

-   -   [1. By the C, the Beautiful
        C](../C1-C_intro/index.html){.nav-link}
        -   [1.1. Getting Started Programming in
            C](../C1-C_intro/getting_started.html){.nav-link}
        -   [1.2. Input/Output (printf and
            scanf)](../C1-C_intro/input_output.html){.nav-link}
        -   [1.3. Conditionals and
            Loops](../C1-C_intro/conditionals.html){.nav-link}
        -   [1.4. Functions](../C1-C_intro/functions.html){.nav-link}
        -   [1.5. Arrays and
            Strings](../C1-C_intro/arrays_strings.html){.nav-link}
        -   [1.6. Structs](../C1-C_intro/structs.html){.nav-link}
        -   [1.7. Summary](../C1-C_intro/summary.html){.nav-link}
        -   [1.8. Exercises](../C1-C_intro/exercises.html){.nav-link}

-   -   [2. A Deeper Dive Into C](../C2-C_depth/index.html){.nav-link}
        -   [2.1. Parts of Program Memory and
            Scope](../C2-C_depth/scope_memory.html){.nav-link}
        -   [2.2. C Pointer
            Variables](../C2-C_depth/pointers.html){.nav-link}
        -   [2.3. Pointers and
            Functions](../C2-C_depth/pointers_functions.html){.nav-link}
        -   [2.4. Dynamic Memory
            Allocation](../C2-C_depth/dynamic_memory.html){.nav-link}
        -   [2.5. Arrays in C](../C2-C_depth/arrays.html){.nav-link}
        -   [2.6. Strings and the String
            Library](../C2-C_depth/strings.html){.nav-link}
        -   [2.7. Structs](../C2-C_depth/structs.html){.nav-link}
        -   [2.8. Input / Output in C](../C2-C_depth/IO.html){.nav-link}
        -   [2.9. Advanced C
            Features](../C2-C_depth/advanced.html){.nav-link}
            -   [2.9.1. Constants, switch, enum, and
                typedef](../C2-C_depth/advanced_switch.html){.nav-link}
            -   [2.9.2. Command Line
                Arguments](../C2-C_depth/advanced_cmd_line_args.html){.nav-link}
            -   [2.9.3. The void\*
                Type](../C2-C_depth/advanced_voidstar.html){.nav-link}
            -   [2.9.4. Pointer
                Arithmetic](../C2-C_depth/advanced_pointer_arithmetic.html){.nav-link}
            -   [2.9.5. C Libraries: Using, Compiling and
                Linking](../C2-C_depth/advanced_libraries.html){.nav-link}
            -   [2.9.6. Writing and using your own C libraries (and
                compiling multiple .c and .h
                files)](../C2-C_depth/advanced_writing_libraries.html){.nav-link}
            -   [2.9.7. Compiling C to Assembly and Compiling Assembly
                Code](../C2-C_depth/advanced_assembly.html){.nav-link}
        -   [2.10. Summary](../C2-C_depth/summary.html){.nav-link}
        -   [2.11. Exercises](../C2-C_depth/exercises.html){.nav-link}

-   -   [3. C Debugging Tools](index.html){.nav-link}
        -   [3.1. Debugging with GDB](gdb.html){.nav-link}
        -   [3.2. GDB Commands in Detail](gdb_commands.html){.nav-link}
        -   [3.3. Debugging Memory with
            Valgrind](valgrind.html){.nav-link}
        -   [3.4. Advanced GDB Features](gdb_advanced.html){.nav-link}
        -   [3.5. Debugging Assembly Code](gdb_assembly.html){.nav-link}
        -   [3.6. Debugging Multi-threaded
            Programs](gdb_pthreads.html){.nav-link}
        -   [3.7. Summary](summary.html){.nav-link}

-   -   [11. Storage and the Memory
        Hierarchy](../C11-MemHierarchy/index.html){.nav-link}
        -   [11.1. The Memory
            Hierarchy](../C11-MemHierarchy/mem_hierarchy.html){.nav-link}
        -   [11.2. Storage
            Devices](../C11-MemHierarchy/devices.html){.nav-link}
        -   [11.3.
            Locality](../C11-MemHierarchy/locality.html){.nav-link}
        -   [11.4. Caching](../C11-MemHierarchy/caching.html){.nav-link}
        -   [11.5. Cache Analysis and
            Cachegrind](../C11-MemHierarchy/cachegrind.html){.nav-link}
        -   [11.6. Looking Ahead: Caching on Multicore
            Processors](../C11-MemHierarchy/coherency.html){.nav-link}
        -   [11.7. Summary](../C11-MemHierarchy/summary.html){.nav-link}
        -   [11.8.
            Exercises](../C11-MemHierarchy/exercises.html){.nav-link}

-   -   [12. Code Optimization](../C12-CodeOpt/index.html){.nav-link}
        -   [12.1. First Steps](../C12-CodeOpt/basic.html){.nav-link}
        -   [12.2. Other Compiler
            Optimizations](../C12-CodeOpt/loops_functions.html){.nav-link}
        -   [12.3. Memory
            Considerations](../C12-CodeOpt/memory_considerations.html){.nav-link}
        -   [12.4. Summary](../C12-CodeOpt/summary.html){.nav-link}

-   -   [13. The Operating System](../C13-OS/index.html){.nav-link}
        -   [13.1. Booting and Running](../C13-OS/impl.html){.nav-link}
        -   [13.2. Processes](../C13-OS/processes.html){.nav-link}
        -   [13.3. Virtual Memory](../C13-OS/vm.html){.nav-link}
        -   [13.4. Interprocess
            Communication](../C13-OS/ipc.html){.nav-link}
            -   [13.4.1. Signals](../C13-OS/ipc_signals.html){.nav-link}
            -   [13.4.2. Message
                Passing](../C13-OS/ipc_msging.html){.nav-link}
            -   [13.4.3. Shared
                Memory](../C13-OS/ipc_shm.html){.nav-link}
        -   [13.5. Summary and Other OS
            Functionality](../C13-OS/advanced.html){.nav-link}
        -   [13.6. Exercises](../C13-OS/exercises.html){.nav-link}

-   -   [14. Leveraging Shared Memory in the Multicore
        Era](../C14-SharedMemory/index.html){.nav-link}
        -   [14.1. Programming Multicore
            Systems](../C14-SharedMemory/multicore.html){.nav-link}
        -   [14.2. POSIX
            Threads](../C14-SharedMemory/posix.html){.nav-link}
        -   [14.3. Synchronizing
            Threads](../C14-SharedMemory/synchronization.html){.nav-link}
            -   [14.3.1. Mutual
                Exclusion](../C14-SharedMemory/mutex.html){.nav-link}
            -   [14.3.2.
                Semaphores](../C14-SharedMemory/semaphores.html){.nav-link}
            -   [14.3.3. Other Synchronization
                Constructs](../C14-SharedMemory/other_syncs.html){.nav-link}
        -   [14.4. Measuring Parallel
            Performance](../C14-SharedMemory/performance.html){.nav-link}
            -   [14.4.1. Parallel Performance
                Basics](../C14-SharedMemory/performance_basics.html){.nav-link}
            -   [14.4.2. Advanced
                Topics](../C14-SharedMemory/performance_advanced.html){.nav-link}
        -   [14.5. Cache
            Coherence](../C14-SharedMemory/cache_coherence.html){.nav-link}
        -   [14.6. Thread
            Safety](../C14-SharedMemory/thread_safety.html){.nav-link}
        -   [14.7. Implicit Threading with
            OpenMP](../C14-SharedMemory/openmp.html){.nav-link}
        -   [14.8. Summary](../C14-SharedMemory/summary.html){.nav-link}
        -   [14.9.
            Exercises](../C14-SharedMemory/exercises.html){.nav-link}

-   -   [15. Looking Ahead: Other Parallel
        Systems](../C15-Parallel/index.html){.nav-link}
        -   [15.1. Hardware Acceleration and
            CUDA](../C15-Parallel/gpu.html){.nav-link}
        -   [15.2. Distributed Memory
            Systems](../C15-Parallel/distrmem.html){.nav-link}
        -   [15.3. To Exascale and
            Beyond](../C15-Parallel/cloud.html){.nav-link}

-   -   [16. Appendix 1: Chapter 1 for Java
        Programmers](../Appendix1/index.html){.nav-link}
        -   [16.1. Getting Started Programming in
            C](../Appendix1/getting_started.html){.nav-link}
        -   [16.2. Input/Output (printf and
            scanf)](../Appendix1/input_output.html){.nav-link}
        -   [16.3. Conditionals and
            Loops](../Appendix1/conditionals.html){.nav-link}
        -   [16.4. Functions](../Appendix1/functions.html){.nav-link}
        -   [16.5. Arrays and
            Strings](../Appendix1/arrays_strings.html){.nav-link}
        -   [16.6. Structs](../Appendix1/structs.html){.nav-link}
        -   [16.7. Summary](../Appendix1/summary.html){.nav-link}
        -   [16.8. Exercises](../Appendix1/exercises.html){.nav-link}

-   -   [17. Appendix 2: Using Unix](../Appendix2/index.html){.nav-link}
        -   [17.1. Unix Command Line and the Unix File
            System](../Appendix2/cmdln_basics.html){.nav-link}
        -   [17.2. Man and the Unix
            Manual](../Appendix2/man.html){.nav-link}
        -   [17.3. Remote Access](../Appendix2/ssh_scp.html){.nav-link}
        -   [17.4. Unix Editors](../Appendix2/editors.html){.nav-link}
        -   [17.5. make and
            Makefiles](../Appendix2/makefiles.html){.nav-link}
        -   [17.6 Searching: grep and
            find](../Appendix2/grep.html){.nav-link}
        -   [17.7 File Permissions](../Appendix2/chmod.html){.nav-link}
        -   [17.8 Archiving and Compressing
            Files](../Appendix2/tar.html){.nav-link}
        -   [17.9 Process Control](../Appendix2/pskill.html){.nav-link}
        -   [17.10 Timing](../Appendix2/timing.html){.nav-link}
        -   [17.11 Command
            History](../Appendix2/history.html){.nav-link}
        -   [17.12 I/0
            Redirection](../Appendix2/ioredirect.html){.nav-link}
        -   [17.13 Pipes](../Appendix2/pipe.html){.nav-link}
        -   [17.14 Dot Files and
            .bashrc](../Appendix2/dotfiles.html){.nav-link}
        -   [17.15 Shell
            Programming](../Appendix2/shellprog.html){.nav-link}
        -   [17.16 Getting System
            Information](../Appendix2/sysinfo.html){.nav-link}



-   [Dive Into Systems](../index-2.html)
-   [3. C Debugging Tools](index.html)
-   [3.4. Advanced GDB Features](gdb_advanced.html)
:::

::: content
::: sect1
## [](#_advanced_gdb_features){.anchor}3.4. Advanced GDB Features {#_advanced_gdb_features}

::: sectionbody
::: paragraph
This section presents advanced GDB features, some of which may make
sense only after reading the [Operating
Systems](../C13-OS/index.html#_the_operating_system){.page} chapter.
:::

::: sect2
### [](#_gdb_and_make){.anchor}3.4.1. GDB and make {#_gdb_and_make}

::: paragraph
GDB accepts the `make` command to rebuild an executable during a
debugging session, and if the build is successful it will run the newly
built program (when issued the `run` command).
:::

::: listingblock
::: content
    (gdb) make
    (gdb) run
:::
:::

::: paragraph
Building from within GDB is convenient for a user who has set many
breakpoints and has fixed one bug but wants to continue the debugging
session. In this case, rather than quitting GDB, recompiling, restarting
GDB with the new executable, and resetting all the breakpoints, a GDB
user can run `make` and start debugging the new version of the program
with all the breakpoints still set. Keep in mind, however, that
modifying the C source and recompiling by running `make` from within GDB
may result in the breakpoints not being at the same logical location in
the new version of the program as in the old version if source code
lines have been added or deleted. When this problem occurs, either exit
GDB and restart the GDB session on the new executable, or use `disable`
or `delete` to disable or delete the old breakpoints and then `break` to
set new breakpoints at the correct locations in the newly compiled
version of the program.
:::
:::

::: sect2
### [](#_attaching_gdb_to_a_running_process){.anchor}3.4.2. Attaching GDB to a Running Process {#_attaching_gdb_to_a_running_process}

::: paragraph
GDB supports debugging a program that is already running (rather than
starting a program to run from within a GDB session) by *attaching* GDB
to a running process. To do this, the user needs to get the process ID
(PID) value:
:::

::: {.olist .arabic}
1.  Get the process's PID using the `ps` shell command:

    ::: listingblock
    ::: content
        # ps to get process's PID (lists all processes started in current shell):
        $ ps

        # list all processes and pipe through grep for just those named a.out:
        $ ps -A | grep a.out
           PID TTY          TIME CMD
           12345 pts/3     00:00:00 a.out
    :::
    :::

2.  Start GDB and attach it to the specific running process (with PID
    12345):

    ::: listingblock
    ::: content
        # gdb <executable> <pid>
        $ gdb a.out 12345
        (gdb)

        # OR alternative syntax: gdb attach <pid>  <executable>
        $ gdb attach 12345 a.out
        (gdb)
    :::
    :::
:::

::: paragraph
Attaching GDB to a process pauses it, and the user can issue GDB
commands before continuing its execution.
:::

::: paragraph
Alternatively, a program can explicitly pause itself to wait for
debugging by calling `kill(getpid(), SIGSTOP)` (as in the
[attach_example.c](_attachments/attach_example.c) example). When the
program pauses at this point, a programmer can attach GDB to the process
to debug it.
:::

::: paragraph
Regardless of how a program pauses, after GDB attaches and the user
enters some GDB commands, the program's execution continues from its
attach point using `cont`. If `cont` doesn't work, GDB may need to
explicitly send the process a `SIGCONT` signal in order to continue its
execution:
:::

::: listingblock
::: content
    (gdb) signal SIGCONT
:::
:::
:::

::: sect2
### [](#_following_a_process_on_a_fork){.anchor}3.4.3. Following a Process on a Fork {#_following_a_process_on_a_fork}

::: paragraph
When GDB debugs a program that calls the `fork()` function to create a
new child process, GDB can be set to follow (to debug) either the parent
process or the child process, leaving the execution of the other process
unaffected by GDB. By default, GDB follows the parent after a call to
`fork()`. To set GDB to follow the child process, instead, use the
`set follow-fork-mode` command:
:::

::: listingblock
::: content
    (gdb) set follow-fork-mode child    # Set gdb to follow child on fork

    (gdb) set follow-fork-mode parent   # Set gdb to follow parent on fork
    (gdb) show follow-fork-mode         # Display gdb's follow mode
:::
:::

::: paragraph
Setting breakpoints at `fork()` calls in the program is useful when the
user wants to change this behavior during a GDB session.
:::

::: paragraph
The [attach_example.c](_attachments/attach_example.c) example shows one
way to \"follow\" both processes on a fork: GDB follows the parent
process after the fork, and the child sends itself a `SIGSTOP` signal to
explicitly pause after the fork, allowing the programmer to attach a
second GDB process to the child before it continues.
:::
:::

::: sect2
### [](#_signal_control){.anchor}3.4.4. Signal Control {#_signal_control}

::: paragraph
The GDB process can send signals to the target process it is debugging
and can handle signals received by the target process.
:::

::: paragraph
GDB can send signals to the process it debugs using the `signal`
command:
:::

::: listingblock
::: content
    (gdb) signal SIGCONT
    (gdb) signal SIGALARM
    ...
:::
:::

::: paragraph
Sometimes a user would like GDB to perform some action when a signal is
received by the debugged process. For example, if a program tries to
access memory with a misaligned memory address for the type it is
accessing, it receives a `SIGBUS` signal and usually exits. The default
behavior of GDB on a `SIGBUS` is also to let the process exit. If,
however, you want GDB to examine the program state when it receives a
`SIGBUS`, you can specify that GDB handle the `SIGBUS` signal
differently using the `handle` command (the `info` command shows
additional information about how GDB handles signals received by the
process during debugging):
:::

::: listingblock
::: content
    (gdb) handle SIGBUS stop    # if program gets a SIGBUS, gdb gets control

    (gdb) info signal           # list info on all signals
    (gdb) info SIGALRM          # list info just for the SIGALRM signal
:::
:::
:::

::: sect2
### [](#_ddd_settings_and_bug_fixes){.anchor}3.4.5. DDD Settings and Bug Fixes {#_ddd_settings_and_bug_fixes}

::: paragraph
Running DDD creates a `.ddd` directory in your home directory, which it
uses to store its settings so that users don't need to reset all their
preferences from scratch on each invocation. Some examples of saved
settings include sizes of subwindows, menu display options, and enabling
windows to view register values and assembly code.
:::

::: paragraph
Sometimes DDD hangs on startup with a \"Waiting until GDB ready\"
message. This often indicates an error in its saved settings files. The
easiest way to fix this is remove the `.ddd` directory (you will lose
all your saved settings and need to reset them when it starts up again):
:::

::: listingblock
::: content
    $ rm -rf ~/.ddd  # Be careful when entering this command!
    $ ddd ./a.out
:::
:::
:::
:::
:::

::: toc-menu
:::
:::
:::
:::

Copyright (C) 2020 Dive into Systems, LLC.

*Dive into Systems,* is licensed under the Creative Commons
[Attribution-NonCommercial-NoDerivatives 4.0
International](https://creativecommons.org/licenses/by-nc-nd/4.0/) (CC
BY-NC-ND 4.0).
