
-   -   [11. Storage and the Memory
        Hierarchy](../C11-MemHierarchy/index.html){.nav-link}
        -   [11.1. The Memory
            Hierarchy](../C11-MemHierarchy/mem_hierarchy.html){.nav-link}
        -   [11.2. Storage
            Devices](../C11-MemHierarchy/devices.html){.nav-link}
        -   [11.3.
            Locality](../C11-MemHierarchy/locality.html){.nav-link}
        -   [11.4. Caching](../C11-MemHierarchy/caching.html){.nav-link}
        -   [11.5. Cache Analysis and
            Cachegrind](../C11-MemHierarchy/cachegrind.html){.nav-link}
        -   [11.6. Looking Ahead: Caching on Multicore
            Processors](../C11-MemHierarchy/coherency.html){.nav-link}
        -   [11.7. Summary](../C11-MemHierarchy/summary.html){.nav-link}
        -   [11.8.
            Exercises](../C11-MemHierarchy/exercises.html){.nav-link}

-   -   [12. Code Optimization](../C12-CodeOpt/index.html){.nav-link}
        -   [12.1. First Steps](../C12-CodeOpt/basic.html){.nav-link}
        -   [12.2. Other Compiler
            Optimizations](../C12-CodeOpt/loops_functions.html){.nav-link}
        -   [12.3. Memory
            Considerations](../C12-CodeOpt/memory_considerations.html){.nav-link}
        -   [12.4. Summary](../C12-CodeOpt/summary.html){.nav-link}

-   -   [13. The Operating System](../C13-OS/index.html){.nav-link}
        -   [13.1. Booting and Running](../C13-OS/impl.html){.nav-link}
        -   [13.2. Processes](../C13-OS/processes.html){.nav-link}
        -   [13.3. Virtual Memory](../C13-OS/vm.html){.nav-link}
        -   [13.4. Interprocess
            Communication](../C13-OS/ipc.html){.nav-link}
            -   [13.4.1. Signals](../C13-OS/ipc_signals.html){.nav-link}
            -   [13.4.2. Message
                Passing](../C13-OS/ipc_msging.html){.nav-link}
            -   [13.4.3. Shared
                Memory](../C13-OS/ipc_shm.html){.nav-link}
        -   [13.5. Summary and Other OS
            Functionality](../C13-OS/advanced.html){.nav-link}
        -   [13.6. Exercises](../C13-OS/exercises.html){.nav-link}

-   -   [14. Leveraging Shared Memory in the Multicore
        Era](../C14-SharedMemory/index.html){.nav-link}
        -   [14.1. Programming Multicore
            Systems](../C14-SharedMemory/multicore.html){.nav-link}
        -   [14.2. POSIX
            Threads](../C14-SharedMemory/posix.html){.nav-link}
        -   [14.3. Synchronizing
            Threads](../C14-SharedMemory/synchronization.html){.nav-link}
            -   [14.3.1. Mutual
                Exclusion](../C14-SharedMemory/mutex.html){.nav-link}
            -   [14.3.2.
                Semaphores](../C14-SharedMemory/semaphores.html){.nav-link}
            -   [14.3.3. Other Synchronization
                Constructs](../C14-SharedMemory/other_syncs.html){.nav-link}
        -   [14.4. Measuring Parallel
            Performance](../C14-SharedMemory/performance.html){.nav-link}
            -   [14.4.1. Parallel Performance
                Basics](../C14-SharedMemory/performance_basics.html){.nav-link}
            -   [14.4.2. Advanced
                Topics](../C14-SharedMemory/performance_advanced.html){.nav-link}
        -   [14.5. Cache
            Coherence](../C14-SharedMemory/cache_coherence.html){.nav-link}
        -   [14.6. Thread
            Safety](../C14-SharedMemory/thread_safety.html){.nav-link}
        -   [14.7. Implicit Threading with
            OpenMP](../C14-SharedMemory/openmp.html){.nav-link}
        -   [14.8. Summary](../C14-SharedMemory/summary.html){.nav-link}
        -   [14.9.
            Exercises](../C14-SharedMemory/exercises.html){.nav-link}

-   -   [15. Looking Ahead: Other Parallel
        Systems](../C15-Parallel/index.html){.nav-link}
        -   [15.1. Hardware Acceleration and
            CUDA](../C15-Parallel/gpu.html){.nav-link}
        -   [15.2. Distributed Memory
            Systems](../C15-Parallel/distrmem.html){.nav-link}
        -   [15.3. To Exascale and
            Beyond](../C15-Parallel/cloud.html){.nav-link}

-   -   [16. Appendix 1: Chapter 1 for Java
        Programmers](../Appendix1/index.html){.nav-link}
        -   [16.1. Getting Started Programming in
            C](../Appendix1/getting_started.html){.nav-link}
        -   [16.2. Input/Output (printf and
            scanf)](../Appendix1/input_output.html){.nav-link}
        -   [16.3. Conditionals and
            Loops](../Appendix1/conditionals.html){.nav-link}
        -   [16.4. Functions](../Appendix1/functions.html){.nav-link}
        -   [16.5. Arrays and
            Strings](../Appendix1/arrays_strings.html){.nav-link}
        -   [16.6. Structs](../Appendix1/structs.html){.nav-link}
        -   [16.7. Summary](../Appendix1/summary.html){.nav-link}
        -   [16.8. Exercises](../Appendix1/exercises.html){.nav-link}

-   -   [17. Appendix 2: Using Unix](index.html){.nav-link}
        -   [17.1. Unix Command Line and the Unix File
            System](cmdln_basics.html){.nav-link}
        -   [17.2. Man and the Unix Manual](man.html){.nav-link}
        -   [17.3. Remote Access](ssh_scp.html){.nav-link}
        -   [17.4. Unix Editors](editors.html){.nav-link}
        -   [17.5. make and Makefiles](makefiles.html){.nav-link}
        -   [17.6 Searching: grep and find](grep.html){.nav-link}
        -   [17.7 File Permissions](chmod.html){.nav-link}
        -   [17.8 Archiving and Compressing Files](tar.html){.nav-link}
        -   [17.9 Process Control](pskill.html){.nav-link}
        -   [17.10 Timing](timing.html){.nav-link}
        -   [17.11 Command History](history.html){.nav-link}
        -   [17.12 I/0 Redirection](ioredirect.html){.nav-link}
        -   [17.13 Pipes](pipe.html){.nav-link}
        -   [17.14 Dot Files and .bashrc](dotfiles.html){.nav-link}
        -   [17.15 Shell Programming](shellprog.html){.nav-link}
        -   [17.16 Getting System Information](sysinfo.html){.nav-link}



-   [Dive Into Systems](../index-2.html)
-   [17. Appendix 2: Using Unix](index.html)
-   [17.8 Archiving and Compressing Files](tar.html)
:::

::: content
::: sect1
## [](#targzbz){.anchor}17.8. Archiving and Compressing Files {#targzbz}

::: sectionbody
::: paragraph
The `tar` (tape archive) utility is used to package up a set of files
into a single file (an **archive file** or a **tar file**). The `tar`
command is also used to extract the files out of a tar file. An archive
file (or tar file) contains all the file data from the files that make
up the tar file plus additional meta-data that describe its contents.
The meta-data are necessary for `tar` to extract the individual file(s)
out of a tar file.
:::

::: paragraph
Tar files are often used to distribute a set of files or to transfer a
set of files from one machine to another. They also may be used to store
backups of sets of files (file archives). For example, if a user who
wants to transfer a set of files from one system to another, they would
first run `tar` with the `-c` command line option to create a single tar
file containing all of the files, then `scp` the resulting tar file to
the remote machine. On the remote machine they would then run `tar` with
`-x` to extract files from the tar file.
:::

::: paragraph
The `tar` command has many command line options for configuring its
behavior in different ways. [Table 1](#TabTarCmdline) lists some
examples.
:::

  Option                 Description
  ---------------------- ------------------------------------------------------
  `-c`                   create a tar file from a set of files
  `-x`                   extract, or untar, a tar file
  `-t`                   list the contents of a tar file
  `-v`                   verbose mode, prints out information as runs command
  `-f <tar file name>`   specifies the name of the tar file

  : Table 1. tar command line options

::: paragraph
To create a tar file you need to use `-c`, specify the name of the tar
output file with `-f` and then give the list of files (and directories)
to include in the tar file (full directory contents will be included).
:::

::: paragraph
Here is an example of how to create a tar file from three regular files
(`main.c`, `process.c`, `Makefile`) and the contents of a directory
(`inputfiles/`):
:::

::: listingblock
::: content
    $ tar -c -v -f mytarfile.tar  main.c process.c Makefile intputfiles/
:::
:::

::: paragraph
`-v` is the verbose command line option. It lists some information about
the files being tar'ed up as tar executes.
:::

::: paragraph
The command line options to `tar` can also be specified using an
alternate, more compact, syntax (this is often used in `tar` examples
you see):
:::

::: listingblock
::: content
    $ tar -cvf mytarfile.tar  main.c process.c Makefile intputfiles/

    $ tar cvf mytarfile.tar  main.c process.c Makefile intputfiles/
:::
:::

::: paragraph
Alternatively, you can create a directory and copy the files you want to
tar into it, and generate a tar file from that directory. For example:
:::

::: listingblock
::: content
    $ mkdir mytardir
    $ cp *.c mytardir/.
    $ cp -r inputfiles mytardir/.
    $ tar cvf mytarfile.tar mytardir
:::
:::

::: paragraph
To list the files in a tar file, use the `-t` command line option:
:::

::: listingblock
::: content
    $ tar -tvf mytarfile.tar
:::
:::

::: paragraph
To extract files from a tar file, use the `-x` command line option:
:::

::: listingblock
::: content
    $ tar xvf mytarfile.tar
:::
:::

::: sect2
### [](#_file_compression){.anchor}17.8.1. file compression {#_file_compression}

::: paragraph
Often times file compression is used along with `tar` to reduce the size
of the tar file. This is useful for both reducing the storage space
required for the tar file, and also to reduce the amount of data that
are sent over the network when a tar file is copied to a remote machine
using `scp`. The `gzip` and `gunzip` are used to compress and uncompress
a file using gzip compression, and `bzip2` and `bunzip2` are used to
compress and uncompress a file using bzip compression. Here are some
example calls:
:::

::: listingblock
::: content
    $ ls -l
    -rw-r--r-- 1 sarita users 40840 Apr 12 16:55 file

    $ gzip file        # compress using gzip
    $ ls -l
    -rw-r--r-- 1 sarita users 13258 Apr 12 16:55 file.gz

    $ gunzip file.gz   # uncompress a gziped file
    $ ls -l
    -rw-r--r-- 1 sarita users 40840 Apr 12 16:55 file

    $ bzip2 file        # compress using bzip2
    $ ls -l
    -rw-r--r-- 1 sarita users 12568 Apr 12 16:55 file.bz2

    $ bunzip2 file.bz2   # uncompress a bzip2ed file
    $ ls -l
    -rw-r--r-- 1 sarita users 40840 Apr 12 16:55 file
:::
:::

::: sect3
#### [](#_tar_and_file_compression){.anchor}tar and file compression {#_tar_and_file_compression}

::: paragraph
File compression is often used on tar files. A user can run file
compression utilities on a tar file after `tar` creates it and run
utilities to uncompress the tar file before running `tar` to extract
files from the tar file. However, because file compression is so
commonly used with tar files, `tar` has command line options to create
compressed tar files (and to extract files from compressed tar files)
using different compression algorithms (for example, `-j` uses `bzip2`,
and `-z` uses gzip).
:::

::: paragraph
Here are some examples of compressing the tar file in one step using the
`-z` option to gzip or `-j` option for bzip: to `tar`:
:::

::: listingblock
::: content
    # use -z option to compress tar file using gzip:
    $ tar -czvf myproj.tar.gz myproj/
    $ ls
      myproj/ myproj.tar.gz


    # or use -j option to compress tar file using bzip2:
    $ tar -cjvf myproj.tar.bz2 myproj/
    $ ls
      myproj/ myproj.tar.bz2
:::
:::

::: paragraph
Alternatively, here is an example of separating the tar file creation
and compression into two steps (create tar file, then compress using
`gzip` (or `bzip2`):
:::

::: listingblock
::: content
    $ tar cvf myproj.tar myproj/   # create a tar file from myproj
    $ ls
      myproj/ myproj.tar

    $ gzip myproj.tar     # gzip the tar file
    $ ls
      myproj/ myproj.tar.gz

    # OR could use bzip
    $ bzip2 myproj.tar     # bzip the tar file
    $ ls
      myproj/ myproj.tar.bz2
:::
:::

::: paragraph
You can also use the one-step or two-step method to extract files from a
compressed tar file. For example, here is the single step way (`-z`
specifies to uncompress the file first using gzip):
:::

::: listingblock
::: content
    $ tar -xzvf myproj.tar.gz
    $ ls
      myproj/ myproj.tar.gz
:::
:::

::: paragraph
Alternatively, here is the two-step method to extract files from a
compressed tar file (first uncompress with gunzip or bunzip2, then
untar):
:::

::: listingblock
::: content
    $ ls
      myproj.tar.gz
    $ gunzip myproj.tar.gz
    $ ls
      myproj.tar
    $ tar -xvf myproj.tar
    $ ls
      myproj/ myproj.tar


    # or using bunzip2 for bzip'ed file
    $ ls
      myproj.tar.bz2
    $ bunzip myproj.tar.bz2
    $ ls
      myproj.tar
    $ tar -xvf myproj.tar
    $ ls
      myproj/ myproj.tar
:::
:::
:::
:::

::: sect2
### [](#_putting_it_all_together){.anchor}17.8.2. putting it all together {#_putting_it_all_together}

::: paragraph
Below is an example of using `tar` to transfer a directory's contents
from one machine (`laptop`) to a remote machine (`ada.cs.college.edu`).
It uses the `scp` command to remotely copy the file between the two
machines (see [Section 17.3](ssh_scp.html#_remote_access){.page} for
more information about `scp`).
:::

::: {.olist .arabic}
1.  First, the user creates the compressed tar file on `laptop` (note:
    we show the two-step method to create and compress the tar file in
    order to show the listing of the files in the tar file, but the
    compressed tar file could also be created in one-step using the
    `-cjvf` command line options):

    ::: listingblock
    ::: content
        laptop$  ls myproj/
          Makefile input1.txt input2.txt main.c mux.c mux.h

        laptop$  tar -cvf myproj.tar myproj/   # create a tar file from myproj
        laptop$  ls
          myproj/ myproj.tar

        laptop$  tar -tf myproj.tar            # list tar file contents
           myproj/
           myproj/Makefile
           myproj/input1.txt
           myproj/input2.txt
           myproj/main.c
           myproj/mux.c
           myproj/mux.h

        laptop$ gzip myproj.tar              # compress the file
    :::
    :::

2.  Then, they scp the single tar file to the remote machine:

    ::: listingblock
    ::: content
        laptop$ scp myproj.tar sam@ada.cs.college.edu:.   # scp single tar file
          sam@ada.cs.college.edu's password:
    :::
    :::

3.  Then the user can then `ssh` into the remote machine, and untar the
    `myproj.tar` file to extract the files:

    ::: listingblock
    ::: content
        laptop$ ssh sam@ada.cs.college.edu
          sam@ada.cs.college.edu's password:

        ada$ ls
         classes/ letters/  myproj.tar projects/

        ada$ tar -xjvf myproj.tar          # extract contents of tar file

        ada$ ls
         classes/ letters/  myproj/  myproj.tar projects/
    :::
    :::
:::

::: paragraph
If the user wanted to untar the directory somewhere other than in their
home directory, they could use `mv` to move the directory where they
want (or they could have also moved the tar file to where they want it
before untaring it). For example, to move it as a subdirectory under the
`project` directory:
:::

::: listingblock
::: content
    ada$ ls
       classes/ letters/  myproj/  myproj.tar projects/
    ada$ mv myproj project/.
    ada$ ls
       classes/ letters/  myproj.tar projects/
    ada$ cd project
    ada$ ls
       myproj/
:::
:::

::: paragraph
Often after untaring a tar file, the user removes the `.tar` file:
:::

::: listingblock
::: content
    rm myproj.tar
    ls
:::
:::
:::

::: sect2
### [](#_references){.anchor}17.8.3. References {#_references}

::: paragraph
For more information see:
:::

::: ulist
-   The man pages for these commands (e.g., `man tar`, `man gunzip`)

-   [most used Unix
    commands](https://www.cheat-sheets.org/project/tldr/command/special-most-used-linux-commands/)
    from cheat-sheets.org

-   [Bash Reference
    Manual](https://www.gnu.org/software/bash/manual/html_node/index.html)
    from gnu.org.
:::
:::
:::
:::

::: toc-menu
:::
:::
:::
:::

Copyright (C) 2020 Dive into Systems, LLC.

*Dive into Systems,* is licensed under the Creative Commons
[Attribution-NonCommercial-NoDerivatives 4.0
International](https://creativecommons.org/licenses/by-nc-nd/4.0/) (CC
BY-NC-ND 4.0).
