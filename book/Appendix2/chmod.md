
-   -   [11. Storage and the Memory
        Hierarchy](../C11-MemHierarchy/index.html){.nav-link}
        -   [11.1. The Memory
            Hierarchy](../C11-MemHierarchy/mem_hierarchy.html){.nav-link}
        -   [11.2. Storage
            Devices](../C11-MemHierarchy/devices.html){.nav-link}
        -   [11.3.
            Locality](../C11-MemHierarchy/locality.html){.nav-link}
        -   [11.4. Caching](../C11-MemHierarchy/caching.html){.nav-link}
        -   [11.5. Cache Analysis and
            Cachegrind](../C11-MemHierarchy/cachegrind.html){.nav-link}
        -   [11.6. Looking Ahead: Caching on Multicore
            Processors](../C11-MemHierarchy/coherency.html){.nav-link}
        -   [11.7. Summary](../C11-MemHierarchy/summary.html){.nav-link}
        -   [11.8.
            Exercises](../C11-MemHierarchy/exercises.html){.nav-link}

-   -   [12. Code Optimization](../C12-CodeOpt/index.html){.nav-link}
        -   [12.1. First Steps](../C12-CodeOpt/basic.html){.nav-link}
        -   [12.2. Other Compiler
            Optimizations](../C12-CodeOpt/loops_functions.html){.nav-link}
        -   [12.3. Memory
            Considerations](../C12-CodeOpt/memory_considerations.html){.nav-link}
        -   [12.4. Summary](../C12-CodeOpt/summary.html){.nav-link}

-   -   [13. The Operating System](../C13-OS/index.html){.nav-link}
        -   [13.1. Booting and Running](../C13-OS/impl.html){.nav-link}
        -   [13.2. Processes](../C13-OS/processes.html){.nav-link}
        -   [13.3. Virtual Memory](../C13-OS/vm.html){.nav-link}
        -   [13.4. Interprocess
            Communication](../C13-OS/ipc.html){.nav-link}
            -   [13.4.1. Signals](../C13-OS/ipc_signals.html){.nav-link}
            -   [13.4.2. Message
                Passing](../C13-OS/ipc_msging.html){.nav-link}
            -   [13.4.3. Shared
                Memory](../C13-OS/ipc_shm.html){.nav-link}
        -   [13.5. Summary and Other OS
            Functionality](../C13-OS/advanced.html){.nav-link}
        -   [13.6. Exercises](../C13-OS/exercises.html){.nav-link}

-   -   [14. Leveraging Shared Memory in the Multicore
        Era](../C14-SharedMemory/index.html){.nav-link}
        -   [14.1. Programming Multicore
            Systems](../C14-SharedMemory/multicore.html){.nav-link}
        -   [14.2. POSIX
            Threads](../C14-SharedMemory/posix.html){.nav-link}
        -   [14.3. Synchronizing
            Threads](../C14-SharedMemory/synchronization.html){.nav-link}
            -   [14.3.1. Mutual
                Exclusion](../C14-SharedMemory/mutex.html){.nav-link}
            -   [14.3.2.
                Semaphores](../C14-SharedMemory/semaphores.html){.nav-link}
            -   [14.3.3. Other Synchronization
                Constructs](../C14-SharedMemory/other_syncs.html){.nav-link}
        -   [14.4. Measuring Parallel
            Performance](../C14-SharedMemory/performance.html){.nav-link}
            -   [14.4.1. Parallel Performance
                Basics](../C14-SharedMemory/performance_basics.html){.nav-link}
            -   [14.4.2. Advanced
                Topics](../C14-SharedMemory/performance_advanced.html){.nav-link}
        -   [14.5. Cache
            Coherence](../C14-SharedMemory/cache_coherence.html){.nav-link}
        -   [14.6. Thread
            Safety](../C14-SharedMemory/thread_safety.html){.nav-link}
        -   [14.7. Implicit Threading with
            OpenMP](../C14-SharedMemory/openmp.html){.nav-link}
        -   [14.8. Summary](../C14-SharedMemory/summary.html){.nav-link}
        -   [14.9.
            Exercises](../C14-SharedMemory/exercises.html){.nav-link}

-   -   [15. Looking Ahead: Other Parallel
        Systems](../C15-Parallel/index.html){.nav-link}
        -   [15.1. Hardware Acceleration and
            CUDA](../C15-Parallel/gpu.html){.nav-link}
        -   [15.2. Distributed Memory
            Systems](../C15-Parallel/distrmem.html){.nav-link}
        -   [15.3. To Exascale and
            Beyond](../C15-Parallel/cloud.html){.nav-link}

-   -   [16. Appendix 1: Chapter 1 for Java
        Programmers](../Appendix1/index.html){.nav-link}
        -   [16.1. Getting Started Programming in
            C](../Appendix1/getting_started.html){.nav-link}
        -   [16.2. Input/Output (printf and
            scanf)](../Appendix1/input_output.html){.nav-link}
        -   [16.3. Conditionals and
            Loops](../Appendix1/conditionals.html){.nav-link}
        -   [16.4. Functions](../Appendix1/functions.html){.nav-link}
        -   [16.5. Arrays and
            Strings](../Appendix1/arrays_strings.html){.nav-link}
        -   [16.6. Structs](../Appendix1/structs.html){.nav-link}
        -   [16.7. Summary](../Appendix1/summary.html){.nav-link}
        -   [16.8. Exercises](../Appendix1/exercises.html){.nav-link}

-   -   [17. Appendix 2: Using Unix](index.html){.nav-link}
        -   [17.1. Unix Command Line and the Unix File
            System](cmdln_basics.html){.nav-link}
        -   [17.2. Man and the Unix Manual](man.html){.nav-link}
        -   [17.3. Remote Access](ssh_scp.html){.nav-link}
        -   [17.4. Unix Editors](editors.html){.nav-link}
        -   [17.5. make and Makefiles](makefiles.html){.nav-link}
        -   [17.6 Searching: grep and find](grep.html){.nav-link}
        -   [17.7 File Permissions](chmod.html){.nav-link}
        -   [17.8 Archiving and Compressing Files](tar.html){.nav-link}
        -   [17.9 Process Control](pskill.html){.nav-link}
        -   [17.10 Timing](timing.html){.nav-link}
        -   [17.11 Command History](history.html){.nav-link}
        -   [17.12 I/0 Redirection](ioredirect.html){.nav-link}
        -   [17.13 Pipes](pipe.html){.nav-link}
        -   [17.14 Dot Files and .bashrc](dotfiles.html){.nav-link}
        -   [17.15 Shell Programming](shellprog.html){.nav-link}
        -   [17.16 Getting System Information](sysinfo.html){.nav-link}



-   [Dive Into Systems](../index-2.html)
-   [17. Appendix 2: Using Unix](index.html)
-   [17.7 File Permissions](chmod.html)
:::

::: content
::: sect1
## [](#fileperms){.anchor}17.7. Viewing and Changing File Permissions {#fileperms}

::: sectionbody
::: paragraph
Every Unix file (and directory) is governed by a set of permissions,
which defines its access rights. The permissions associated with a file
are:
:::

::: ulist
-   `r`: read access to the file or directory

-   `w`: write access to the file or directory

-   `x`: execute access to the file or directory (for a directory, this
    means you can `cd` into it, for a file it means you can execute it
    at the command line (e.g., `./filename`). The compiler automatically
    sets the target executable file with `x` permission for the owner.
:::

::: paragraph
Each file's permissions also specifies three sets of users: the file
user/owner (`u`); users in the same group as the file's group (`g`); and
other (`o`) or everybody else. By changing the file permissions with a
file, you can protect or share files in different ways these different
sets of users. For example, file permission can be set to give the owner
read and write access, users in the file's group read access, and
everybody else no read or write access.
:::

::: paragraph
To list file permissions with files and directories use the `-l` command
line option of `ls`:
:::

::: listingblock
::: content
``` {.highlightjs .highlight}
$ls -l
drwx------ 3 sam users 4096 Mar 26 12:49 classes/
drwx------ 2 sam users 4096 Mar 26 12:54 letters/
-rw-r----- 1 sam pals    78 Mar 26 12:51 notes
drwx------ 2 sam users 4096 Mar 26 12:48 projects/
```
:::
:::

::: paragraph
The output from `ls -l` is in the following format (showing the listing
of `notes` as an example):
:::

::: listingblock
::: content
    type   permissions  links  owner  group  size  modification date   name
           u   g   o
     -    rw- r-- ---    1     sam    pals   78    Mar 26 12:51       notes
     d    rwx --- ---    3     sam    users 4096   Mar 26 12:49       classes/
:::
:::

::: paragraph
The `type` is `d` for directories and `-` for regular files. The file
permission listings are in three groups of `rwx` specifying permissions
for the file user or owner (`u`), group (`g`), and others (`o`). For
example, the `-rw-r-----` associated with the `notes` file means that
the file owner `sam` has read and write access to the file (`rw-`), that
the file's group, `pals` has read permission only (`r--`), and others
have no permissions to access the file (`---`). The other fields in the
listing show the username of the file owner (`sam`), the name of the
file's group (`pals`), the size of the file in bytes (`78`), the last
time the file was modified (`Mar 26 12:51`) and the name of the file
(`notes`). Also listed are the number of hard links to the file (`1`),
which is the number of names in the directory structure that refer to
this same file.
:::

::: paragraph
The listing for `classes` is `drwx------`, which means that `classes` is
a directory, the file owner `sam` has read, write, and execute
permissions (`rwx`), and that the directory's group (`users`) and others
have no access permissions (`---`). In other words this is a private
directory to the user `sam`; no one else can access this directory. We
note that a directory must have execute (`x`) permission set in order to
`cd` into it. Directories have link sizes greater than `1` because both
the directory name (e.g., `classes`) and the name `./` in the directory
(and the name `../` in any of its subdirectories) refer to the same
directory. Because `classes` has one subdirectory, `CS31`, its link
value is `3`.
:::

::: sect2
### [](#_chmod){.anchor}17.7.1. chmod {#_chmod}

::: paragraph
The `chmod` command changes the permissions on a file or directory. It
takes command line arguments that specify how to change the permissions
for the three sets of users associated with every file: user/owner,
group, and other.
:::

::: paragraph
One way to run `chmod` is to give a three digit number as a command line
argument that encodes how to set the permissions. The first digit
specifies the permissions for the file user/owner, the second digit
specifies the permissions for the file group, and the third for all
other users. For example, `chmod 700 letters` makes `letters` a private
directory; `7` sets the user's permissions to `rwx`, and `0` set
permissions to `---` for group and others.
:::

::: paragraph
To understand what the digits mean, consider each digit represented as a
three bit binary number where a `1` means grant the permission and `0`
means don't grant it for the set `rwx`. [Table 1](#TabPermEncodings)
shows some examples.
:::

  Digit   Binary   Permission
  ------- -------- -----------------------------------
  `7`     `111`    set rwx permissions
  `5`     `101`    set r x permissions only
  `4`     `100`    set r permission only
  `6`     `110`    set rw permissions only
  `0`     `000`    clear all permissions...​no access

  : Table 1. chmod Permission Encoding Examples

::: paragraph
For example, if `sam` wants to give read access to the `notes` file with
all other users and give himself read and write access, he would run the
following command:
:::

::: listingblock
::: content
``` {.highlightjs .highlight}
$ chmod 644 notes
$ ls -l
drwx------ 3 sam users  4096 Mar 26 12:49 classes/
drwx------ 2 sam users  4096 Mar 26 12:54 letters/
-rw-r--r-- 1 sam pals     78 Mar 26 12:51 notes
drwx------ 2 sam users  4096 Mar 26 12:48 projects/
```
:::
:::

::: paragraph
The `644` sets the permissions on `notes` to `-rw-r—​r--`: `6` gives the
file's owner `rw-` access; `4` gives the file's group `r--` access; and
`4` gives other `r--` access.
:::

::: paragraph
The `chmod` command can also use the `[u,g,o][+,-][permissions]` setting
format too. For example, if `sam` wants to give the `users` group write
access to the `projects` directory, he can specify this permission using
`g+w` (add write permission to group), and if he wants to remove read
access from `notes` to others, he can specify `o-r` (remove read
permission from all):
:::

::: listingblock
::: content
``` {.highlightjs .highlight}
$ chmod g+w projects
$ chmod o-r notes
$ ls -l
drwx------ 3 sam users 4096 Mar 26 12:49 classes/
drwx------ 2 sam users 4096 Mar 26 12:54 letters/
-rw-r----- 1 sam pals    78 Mar 26 12:51 notes
drwx-w---- 2 sam users  4096 Mar 26 12:48 projects/
```
:::
:::

::: paragraph
And when he realizes that giving the `users` group write access to his
`projects` directory was a terrible idea, he can remove it using `g-w`:
:::

::: listingblock
::: content
``` {.highlightjs .highlight}
$ chmod g-w projects
$ ls -l projects
drwx------ 2 sam users  4096 Mar 26 12:48 projects/
```
:::
:::

::: paragraph
The `chmod` command has other command line options, including a
recursive flag to recursively change permissions on a full
subdirectory's contents. See the man page for more details.
:::

::: paragraph
Linux also supports **access control lists** (ACLs), which allow a much
richer set of permissions to be associated with files and directories.
The man page for `getfacl` and `setfacl` contain information about ACLs,
but the details are beyond the scope of our coverage.
:::
:::

::: sect2
### [](#_chgrp){.anchor}17.7.2. chgrp {#_chgrp}

::: paragraph
The `chgrp` command can be used to change the group associated with a
file or directory. Unix groups typically need to be created by a system
administrator who has root access on the system (the root user is the
Unix superuser account that has access rights to the filesystem that a
regular user does not have).
:::

::: paragraph
If the user `sam` is part of a group named `proj3` with two other users,
`sam` can change the group and set permissions on their `projects`
directory to give just this group elevated rights to the directory. For
example:
:::

::: listingblock
::: content
``` {.highlightjs .highlight}
$ chgrp proj3 projects  # change the projects directory's group to proj3
$ ls -l
drwx------ 3 sam users  4096 Mar 26 12:49 classes/
drwx------ 2 sam users  4096 Mar 26 12:54 letters/
-rw-r----- 1 sam pals     78 Mar 26 12:51 notes
drwx------ 2 sam proj3 4096 Mar 26 12:48 projects/

$ chmod 750 projects    # give proj3 group members r and x access to directory
$ ls -l
drwx------ 3 sam users  4096 Mar 26 12:49 classes/
drwx------ 2 sam users  4096 Mar 26 12:54 letters/
-rw-r----- 1 sam pals     78 Mar 26 12:51 notes
drwxr-x--- 2 sam proj3 4096 Mar 26 12:48 projects/
```
:::
:::

::: paragraph
Similarly, the `chown` command changes the owner of a file, but you need
to have root privileges to run it.
:::

::: {.admonitionblock .note}
+-----------------------------------+-----------------------------------+
|                                   | ::: title                         |
|                                   | File group setting and default    |
|                                   | permissions                       |
|                                   | :::                               |
|                                   |                                   |
|                                   | ::: paragraph                     |
|                                   | Each user has default permissions |
|                                   | and a default group that will     |
|                                   | automatically be associated with  |
|                                   | all new files and directories the |
|                                   | user creates. Both of these can   |
|                                   | be modified in your shell's       |
|                                   | config file (e.g., `.bashrc`).    |
|                                   | See [Section                      |
|                                   | 17.1                              |
|                                   | 4](dotfiles.html#DotFiles){.page} |
|                                   | for more information about dot    |
|                                   | files.                            |
|                                   | :::                               |
|                                   |                                   |
|                                   | ::: paragraph                     |
|                                   | Your default group is specified   |
|                                   | in the shell environment variable |
|                                   | named `GROUP`. You can list its   |
|                                   | value using `echo $GROUP`:        |
|                                   | :::                               |
|                                   |                                   |
|                                   | ::: listingblock                  |
|                                   | ::: content                       |
|                                   | ``` {.highlightjs .highlight}     |
|                                   | $ echo $GROUP                     |
|                                   | GROUP=users                       |
|                                   | ```                               |
|                                   | :::                               |
|                                   | :::                               |
|                                   |                                   |
|                                   | ::: paragraph                     |
|                                   | Your default file permission are  |
|                                   | configured from the `umask`       |
|                                   | setting in your `.bashrc` file.   |
|                                   | You can list its value using      |
|                                   | `umask`:                          |
|                                   | :::                               |
|                                   |                                   |
|                                   | ::: listingblock                  |
|                                   | ::: content                       |
|                                   | ``` {.highlightjs .highlight}     |
|                                   | $ umask                           |
|                                   | 77                                |
|                                   | ```                               |
|                                   | :::                               |
|                                   | :::                               |
|                                   |                                   |
|                                   | ::: paragraph                     |
|                                   | A `umask` of `77` (or `077`)      |
|                                   | makes all my files and            |
|                                   | directories private (it sets the  |
|                                   | group and other permissions to 00 |
|                                   | or `------`). You can think of    |
|                                   | the umask encoding as being sort  |
|                                   | of like the inverse of the chmod  |
|                                   | encoding (e.g., `7` removes all   |
|                                   | permissions (`rwx`) in `umask`    |
|                                   | but grants all in chmod).         |
|                                   | :::                               |
+-----------------------------------+-----------------------------------+
:::
:::

::: sect2
### [](#_references){.anchor}17.7.3. References {#_references}

::: paragraph
For more information see:
:::

::: ulist
-   The man pages for these commands (e.g., `man chmod`)

-   [most used Unix
    commands](https://www.cheat-sheets.org/project/tldr/command/special-most-used-linux-commands/)
    from cheat-sheets.org

-   [Bash Reference
    Manual](https://www.gnu.org/software/bash/manual/html_node/index.html)
    from gnu.org.
:::
:::
:::
:::

::: toc-menu
:::
:::
:::
:::

Copyright (C) 2020 Dive into Systems, LLC.

*Dive into Systems,* is licensed under the Creative Commons
[Attribution-NonCommercial-NoDerivatives 4.0
International](https://creativecommons.org/licenses/by-nc-nd/4.0/) (CC
BY-NC-ND 4.0).
